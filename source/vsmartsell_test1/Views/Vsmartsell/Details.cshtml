@model vsmartsell_test1.Models.KhachHang
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    body a {
        color: white;
    }

    a:hover {
        color: #666666;
        text-decoration: none;
    }

    .nav-tabs > li.active > a,
    .nav-tabs > li.active > a:hover,
    .nav-tabs > li.active > a:focus {
        color: #555 !important;
        cursor: default;
        background-color: #fff;
        border: 1px solid #ddd;
        border-bottom-color: transparent;
    }

    .control-label {
        margin-top: 10px;
    }

    .form-group {
        margin-bottom: 50px;
    }
</style>
<head>
    <link href="~/Scripts/style.css" rel="stylesheet" />
    @*<link href="~/Scripts/bootstrap.min.css" rel="stylesheet" />*@
    @*<link href="~/Script/bootstrap.css" rel="stylesheet" />*@
    <link href="~/Scripts/summernote.css" rel="stylesheet" />
    <link href="~/Scripts/font-awesome.css" rel="stylesheet" />
    <script src="~/Scripts/angular.min.js"></script>
    <link href="~/Script/dao.css" rel="stylesheet" />
    <link href="~/Scripts/font-awesome.min.css" rel="stylesheet" />
</head>

<body class="page-header-fixed bg-1" ng-app="IndexApp" ng-controller="indexcontrol">

    <div class="row">
        <!-- Trigger the modal with a button -->

        <div class="modal fade" id="myModal" role="dialog">
            <div class="modal-dialog" style="margin-left">

                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        @*<button type="button" class="close" data-dismiss="modal">&times;</button>*@
                        <h3 class="modal-title"><strong>Thanh toán tiền</strong></h3>
                    </div>

                    <div class="modal-footer" style="margin-top:0px">


                        <div class="col-md-10" style="width:490px">
                            <div class="form-group col-md-12">
                                <label class="control-label col-md-4"><strong>Ngày thanh toán</strong></label>
                                <div class="col-md-8">
                                    <div class="input-group date datepicker" data-date-autoclose="true" data-date-format="dd-mm-yyyy">
                                        <input class="form-control" type="text"><button class="input-group-addon" id="ngaythanhtoan"><i class="fa fa-calendar"></i></button>
                                        
                                    </div>
                                </div>

                            </div>
                            <div class="form-group col-md-12">
                                <label class="control-label col-md-4"><strong>Nhân viên thu tiền</strong></label>
                                <div class="col-md-8">
                                    <input class="form-control" placeholder="" type="text">
                                </div>
                            </div>
                            <div class="form-group col-md-12">
                                <label class="control-label col-md-4" for="disabledInput"><strong>Mã giao dịch</strong></label>
                                <div class="col-md-8">
                                    <input class="form-control" id="disabledInput" disabled placeholder="" type="text">
                                </div>
                            </div>
                            <div class="form-group col-md-12">
                                <label class="control-label col-md-4"><strong>Thời hạn</strong></label>
                                <div class="col-md-8">
                                    <select class="form-control"><option value="Category 1">1 tháng</option><option value="Category 2">3 tháng</option><option value="Category 3">6 tháng</option><option value="Category 4">Trả hết</option></select>
                                </div>
                            </div>
                            <div class="form-group col-md-12">
                                <label class="control-label col-md-4"><strong>Cước phí</strong></label>
                                <div class="col-md-8">
                                    <div class="input-group">
                                        <input class="form-control" type="text"><span class="input-group-addon">/tháng</span>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group col-md-12">
                                <label class="control-label col-md-4"><strong>Thành tiền</strong></label>
                                <div class="col-md-8">
                                    <div class="input-group">
                                        <input class="form-control" disabled type="text"><span class="input-group-addon">VNĐ</span>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group col-md-12">
                                <label class="control-label col-md-4"><strong>Tiền giảm</strong></label>
                                <div class="col-md-8">
                                    <div class="input-group">
                                        <input class="form-control" type="text"><span class="input-group-addon">VNĐ</span>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group col-md-12">
                                <label class="control-label col-md-4" for="disabledInput"><strong>Tổng tiền</strong></label>
                                <div class="col-md-8">
                                    <input class="form-control" id="disabledInput" disabled placeholder="" type="text">
                                </div>
                            </div>
                            <div class="form-group col-md-12">
                                <label class="control-label col-md-4"><strong>Ghi chú</strong></label>
                                <div class="col-md-8">
                                    <input class="form-control" placeholder="" type="text">
                                </div>
                            </div>
                        </div>



                        <div class="col-md-8" style="float:right">
                            <button type="button" class="btn btn-primary">
                                <i class="fa fa-shopping-cart"></i>
                                <span class="" id="cartnotice">Thanh Toán</span>
                            </button>
                            <button class="btn btn-danger" data-dismiss="modal">
                                <i class="fa fa-trash-o"></i>Hủy
                            </button>
                        </div>




                    </div>
                </div>

            </div>
        </div>
    </div>

    @using (Html.BeginForm())
    {
        @Html.AntiForgeryToken()
        <div class="row">
            <div class="col-lg-12">                
                <button style="float:right" type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">
                    <i class="fa fa-shopping-cart"></i> Thanh Toán
                </button>
                <button style="float:right" type="submit" value="" class="btn btn-success">
                    <i class="glyphicon glyphicon-floppy-save"></i> Lưu
                </button>
                <button style="float:right" id="backindex" class="btn btn-default">
                    <i class="fa fa-mail-reply">
                    </i> Quay lại
                </button>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">

                <div class="col-lg-12">
                    <div class="widget-container fluid-height clearfix">
                        <div class="heading tabs" style="background:rgb(150, 150, 150)">
                            <strong style="color:white;font-size:20px">Thông tin khách hàng  </strong><strong style="color:#000000;font-size:20px;text-transform:uppercase"> @Html.DisplayTextFor(model => model.TenKH)</strong>
                            <ul class="nav nav-tabs pull-right" data-tabs="tabs" id="tabs">
                                <li class="active">
                                    <a data-toggle="tab" href="#tab1"><i class="fa fa-info-circle"></i><span><strong>Thông tin khách hàng</strong></span></a>
                                </li>
                                <li class="">
                                    <a data-toggle="tab" href="#tab2"><i class="fa fa-info-circle"></i><span><strong>Thông tin gói cước</strong></span></a>
                                </li>
                                <li class="">
                                    <a data-toggle="tab" href="#tab3"><i class="fa fa-calendar"></i><span><strong>Lịch sử giao dịch khách hàng</strong></span></a>
                                </li>
                            </ul>
                        </div>
                        <div id="loadingicon"></div>
                        <div class="tab-content padded" hidden id="my-tab-content" style="background:rgb(251, 251, 248);">
                            <div class="tab-pane active" id="tab1" style="font-size:20px;line-height: 50px;">                                
                                <ul>

                                    <div class="col-lg-6">
                                        <strong>Tên khách hàng :</strong>
                                        @Html.TextBoxFor(model => model.TenKH, new { @class = "form-control" })
                                    </div>
                                    <div class="col-lg-offset-6">
                                        <strong>Tên cửa hàng :</strong>
                                        @Html.TextBoxFor(model => model.TenCH, new { @class = "form-control" })
                                    </div>
                                    <div class="col-lg-6">
                                        <strong>Số điện thoại :</strong>
                                        @Html.TextBoxFor(model => model.Phone, new { @class = "form-control" })
                                    </div>
                                    <div class="col-lg-offset-6">
                                        <strong>Loại khách hàng :</strong>
                                        @Html.TextBoxFor(model => model.LoaiKH, new { @class = "form-control" })
                                    </div>
                                    <div class="col-lg-6">
                                        <strong>Email :</strong>
                                        @Html.TextBoxFor(model => model.Email, new { @class = "form-control" })
                                    </div>
                                    <div class="col-lg-offset-6">
                                        <strong>Người hỗ trợ :</strong>
                                        @Html.TextBoxFor(model => model.HoTro, new { @class = "form-control" })
                                    </div>
                                    <div hidden class="col-lg-6">
                                        <strong>Mã khách hàng :</strong>
                                        @Html.TextBoxFor(model => model.MaKH, new { @class = "form-control" })
                                    </div>
                                    <div hidden class="col-lg-6">
                                        <strong> Tình trạng :</strong>
                                        @Html.TextBoxFor(model => model.Archive, new { @class = "form-control" })
                                    </div>
                                    <div class="col-lg-6">
                                        <strong>Địa chỉ :</strong>
                                        @Html.TextAreaFor(model => model.DiaChi, new { @class = " form-control", style = "max-width:700px", rows = "3" })
                                    </div>
                                    <div class="col-lg-offset-6">
                                        <strong>Ghi chú :</strong>
                                        @Html.TextAreaFor(model => model.Note, new { @class = " form-control", style = "max-width:700px", rows = "3" })
                                    </div>


                                </ul>
                            </div>

                            <div class="tab-pane" id="tab2" style="font-size: 20px;line-height:50px">
                                <ul>
                                    <div class="col-lg-6">
                                        <strong>Gói sử dụng : </strong>
                                        @Html.DropDownListFor(model => model.LoaiGoi, new SelectList(ViewBag.listgoi), new { @class = "form-control" })
                                       
                                    </div>
                                    <div class="col-lg-offset-6">
                                        <strong>Ngày bắt đầu :</strong>
                                        @Html.TextBoxFor(model => model.NgayDangKy, "{0:yyyy-MM-dd}", new { @class = "form-control", @type = "date" })
                                    </div>
                                    <div class="col-lg-6">
                                        <strong>Giá gói sử dụng :</strong>
                                        <input disabled id="giatien" type="text" class="form-control" value="{{GiaTien}}">
                                    </div>
                                    <div class="col-lg-offset-6">
                                        <strong>Ngày hết hạn :</strong>
                                        @Html.TextBoxFor(model => model.NgayHetHan, "{0:yyyy-MM-dd}", new { @class = "form-control", @type = "date" })
                                    </div>
                                    @*<div class="col-lg-12">
                                        <strong>Ghi chú :</strong>
                                        @Html.TextAreaFor(model => model.Note, new { @class = "form-control", style = "max-width:700px", rows = "3" })
                                    </div>*@


                                </ul>
                            </div>

                            <div class="tab-pane" id="tab3" style="font-size: 20px;">

                                <div class="widget-content padded">
                                    <ul>
                                        <table class="table table-striped">
                                            <thead>
                                                <tr>
                                                    <th style="font-size: 20px;">
                                                        Thời gian
                                                    </th>
                                                    <th style="font-size: 20px;">
                                                        Số tiền trả
                                                    </th>
                                                    <th style="font-size: 20px;">
                                                        Người thu tiền
                                                    </th>
                                                    <th style="font-size: 20px;">
                                                        Ngày hết hạn
                                                    </th>
                                                </tr>
                                                <tr ng-repeat="m in ListGD">
                                                    <td>
                                                        {{todate(m.NgayGD)}}
                                                    </td>
                                                    <td>
                                                        {{m.SoTien}}
                                                    </td>
                                                    <td>
                                                        {{m.NguoiThu}}
                                                    </td>
                                                    <td class="hidden-xs">
                                                        {{todate(m.NgayHetHan)  }}
                                                    </td>
                                                </tr>
                                            </thead>
                                        </table>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>



            </div>
        </div>
    }
</body>
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
<script src="~/Scripts/jquery.session.js"></script>
    <script type="text/javascript">
    $(".btn .btn-default").click(function () {
        //alert();
    })

    var loadingIcon = '<div class="sk-circle"><div class="sk-circle1 sk-child"></div><div class="sk-circle2 sk-child"></div><div class="sk-circle3 sk-child"></div><div class="sk-circle4 sk-child"></div><div class="sk-circle5 sk-child"></div><div class="sk-circle6 sk-child"></div><div class="sk-circle7 sk-child"></div><div class="sk-circle8 sk-child"></div><div class="sk-circle9 sk-child"></div><div class="sk-circle10 sk-child"></div><div class="sk-circle11 sk-child"></div><div class="sk-circle12 sk-child"></div></div>'
    $('#my-tab-content').find('tbody').hide();
    //$('#dataTable1').find('tbody').hide();
    $('#loadingicon').append(loadingIcon);

    var app = angular.module("IndexApp", [])
    app.controller('indexcontrol', function ($scope, $http) {
        $http.get("http://localhost:3469/Vsmartsell/GetKH/@ViewBag.makh").success(function (response) {
            var khachhang = response.khachhang[0];
            $scope.khachhang = khachhang;


            $http.get("http://localhost:3469/Vsmartsell/GetListGiaTien").success(function (response) {
                for(var m in response.ListGiaTien)
                {
                    if (khachhang.LoaiGoi == response.ListGiaTien[m].LoaiGoi)
                    {
                        $scope.GiaTien = response.ListGiaTien[m].GiaTien;
                        break;
                    }
                }
                });
        });

        $http.get("http://localhost:3469/Vsmartsell/GetListGD/@ViewBag.makh").success(function (response) {
            debugger;
            var ListGD = response.ListGD;
            $scope.ListGD = ListGD;
            $('#my-tab-content').removeAttr('hidden');
            $('.sk-circle').remove();

        });

        $http.get("http://localhost:3469/Vsmartsell/GetListGiaTien").success(function (response) {
            function changegia() {
                var loaigoi = $("#LoaiGoi").val()
                var giagoi;
                for (var m in response.ListGiaTien) {

                    if (loaigoi == response.ListGiaTien[m].LoaiGoi) {
                        giagoi = response.ListGiaTien[m].GiaTien;
                        $("#giatien").val(giagoi);
                        break;
                    }

                }
                }
            $("select").change(changegia);
        });
        $scope.todate = function (strdate) {
            var newdate = new Date(parseInt(strdate.substr(6)));
            var todate = ('0' + newdate.getDate()).slice(-2) + '-' + ('0' + (newdate.getMonth() + 1)).slice(-2) + '-' + newdate.getFullYear();
            return todate;
        };

    });
   
        $('#ngaythanhtoan').click(function () {
            alert();
        });
        $('#backindex').click(function () {
           
        })
    </script>
}