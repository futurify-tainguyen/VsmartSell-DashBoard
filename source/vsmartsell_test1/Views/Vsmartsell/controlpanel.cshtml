<!DOCTYPE html>

<html>
<head>
    <link href="~/Scripts/font-awesome.min.css" rel="stylesheet" />
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>
    <style>
        body a {
            color: #2D7AFE;
        }

        a:hover {
            color: #666666;
            text-decoration: none;
        }
        .nav-tabs > li.active > a,
        .nav-tabs > li.active > a:hover,
        .nav-tabs > li.active > a:focus {
            color: #555 !important;
            cursor: default;
            background-color: #fff;
            border: 1px solid #ddd;
            border-bottom-color: transparent;
        }
        .col-md-9 {
            padding-right: 0px !important;
        }
        .col-md-4 {
            text-align: center !important;
            padding-left: 0px !important;
            padding-right: 0px !important;
        }
        .form-control {
            margin-bottom: 20px;
        }
    </style>
    <link href="~/Scripts/style.css" rel="stylesheet" />
    <link href="~/Scripts/summernote.css" rel="stylesheet" />
    <link href="~/Scripts/font-awesome.css" rel="stylesheet" />
    <script src="~/Scripts/angular.min.js"></script>
    <link href="~/Scripts/datepicker3.css" rel="stylesheet" />
    <link href="~/Script/dao.css" rel="stylesheet" />
    @*<link href="~/Scripts/font-awesome.min.css" rel="stylesheet" />*@
</head>
<body ng-app="IndexApp" ng-controller="indexcontrol">
    <div class="row">
        <div class="col-md-12">
            <div class="col-md-12" style="padding-bottom:20px">
                <div class="widget-container fluid-height clearfix">
                    <div class="heading tabs" style="">
                        <strong style="font-size:20px">Bảng điều khiển  </strong>
                        <ul class="nav nav-tabs pull-right col-md-9" data-tabs="tabs" id="tabs">
                            <li class="active col-md-4" style="text-align:center">
                                <a data-toggle="tab" href="#tab1"><i class="fa fa-user"></i><span>Danh sách loại gói</span></a>
                            </li>
                            <li class="col-md-4" style="text-align:center">
                                <a data-toggle="tab" href="#tab2"><i class="fa fa-info-circle"></i><span>Quản lý gửi mail</span></a>
                            </li>
                            <li class="col-md-4" style="text-align:center">
                                <a data-toggle="tab" href="#tab3"><i class="fa fa-list"></i><span>Bảng 3</span></a>
                            </li>
                        </ul>
                    </div>
                    <div id="loadingicon"></div>
                    <div class="tab-content padded" hidden id="my-tab-content" style="">
                        @*---------------TAB1 LoaiGoi---------------*@
                        <div class="tab-pane active" id="tab1" style="font-size:20px;line-height: 50px;">
                            <div class="col-md-12">
                                <div class="col-md-4" ng-repeat="n in ListGiaTien">
                                    @*<button style="width:500px;height:500px"></button>*@
                                    <div class="widget-container fluid-height" style="background-color: #F6F6F6; margin-right: 120px; margin-left: 100px; margin-bottom: 50px; margin-top: 35px; width: 350px; height: 350px">
                                        <div class="col-md-12" style="font-size:30px;padding-top:50px">
                                            <strong style="margin-top:100px">Loại gói : {{n.LoaiGoi}}</strong>
                                        </div>
                                        <div class="col-md-12" style="font-size:20px">
                                            Giá gói  : {{n.GiaTien}}
                                        </div>
                                        <div class="col-md-12" style="padding-top:100px;">
                                            <button id="" style="margin-bottom: 0px;" class="btn btn-primary" ng-click="taogoi(n.MaGoi,n.LoaiGoi,n.GiaTien)" data-toggle="modal" data-target="#myModal">
                                                <i class="glyphicon glyphicon-pencil"></i> Sửa
                                            </button>
                                            <button id="" style="margin-bottom: 0px;" class="btn btn-danger" ng-click="xoagoi(n.MaGoi)" >
                                                <i class="glyphicon glyphicon-pencil"></i> Xóa
                                            </button>
                                        </div>

                                    </div>
                                </div>
                                <div class="col-md-4" >
                                    <div class="widget-container fluid-height" style="background-color: #F6F6F6; margin-right: 120px; margin-left: 100px; margin-bottom: 50px; margin-top: 35px; width:350px;height:350px">
                                        <button id="taogoi" class="btn btn-primary-outline" style="width: 250px; height: 250px; margin-top: 50px; border-style: dashed;" data-toggle="modal" data-target="#myModal">
                                            <i class="glyphicon glyphicon-plus" style="font-size: 500%; "></i>
                                        </button> 
                                        <!-- Modal -->
                                        <div id="myModal" class="modal fade" role="dialog">
                                            <div class="modal-dialog">

                                                <!-- Modal content-->
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                        <h4 class="modal-title">Thêm loại gói</h4>
                                                    </div>
                                                    <div class="modal-body">
                                                        <div class="container" style="max-width:inherit">                                               
                                                            <div class="col-lg-4">Loại gói</div>
                                                            <div class="col-lg-8"><input id="loaigoi" class="form-control" type="text" /></div>
                                                            <div class="col-lg-4">Giá gói</div>
                                                            <div class="col-lg-8"><input id="giagoi" class="form-control" type="text" /></div>
                                                        </div>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button id="taogoi1" style="margin-bottom: 0px;" class="btn btn-success">
                                                            <i class="glyphicon glyphicon-user"></i> Thêm
                                                        </button>
                                                        <button id="taogoi2" style="margin-bottom: 0px;" class="btn btn-success">
                                                            <i class="glyphicon glyphicon-pencil"></i> Sửa
                                                        </button>
                                                        <button id="huy" type="button" class="btn btn-danger" data-dismiss="modal">
                                                            <i class="glyphicon glyphicon-trash"></i>Close
                                                        </button>
                                                    </div>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                        <div class="tab-pane " id="tab2" style="font-size: 20px;line-height:50px">
                            <div class="container" style="max-width:inherit">
                                <div class="col-lg-4">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr>
                                                <th hidden></th>
                                                <th style="font-size: 20px; text-align: center;">
                                                    Email khách hàng sắp hết hạn
                                                    
                                                </th>
                                                <th>
                                                    <button id="saphethan" style="margin-bottom: 0px;" class="btn btn-xs btn-primary" data-toggle="modal" data-target="#myModal1">
                                                        <i class="glyphicon glyphicon-user"></i> Thêm
                                                    </button>
                                                    <!-- Modal -->
                                                    <div id="myModal1" class="modal fade" role="dialog">
                                                        <div class="modal-dialog">

                                                            <!-- Modal content-->
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                                    <h4 class="modal-title">Thêm email khách hàng </h4>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <div class="container" style="max-width:inherit">
                                                                        <div class="col-lg-4">Email</div>
                                                                        <div class="col-lg-8"><input id="email1" class="form-control" type="text" /></div>
                                                                    </div>

                                                                </div>
                                                                <div class="modal-footer">
                                                                    <button id="saphethan1" style="margin-bottom: 0px;" class="btn btn-success">
                                                                        <i class="glyphicon glyphicon-user"></i> Thêm
                                                                    </button>
                                                                    <button id="dahethan1" style="margin-bottom: 0px;" class="btn btn-success">
                                                                        <i class="glyphicon glyphicon-user"></i> Thêm
                                                                    </button>
                                                                    <button id="chuathanhtoan1" style="margin-bottom: 0px;" class="btn btn-success">
                                                                        <i class="glyphicon glyphicon-user"></i> Thêm
                                                                    </button>
                                                                    <button id="saphethan2" style="margin-bottom: 0px;" class="btn btn-success">
                                                                        <i class="glyphicon glyphicon-pencil"></i> Sửa
                                                                    </button>
                                                                    <button id="huy1" type="button" class="btn btn-danger" data-dismiss="modal">
                                                                        <i class="glyphicon glyphicon-trash"></i>Close
                                                                    </button>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="n in ListMail |filter:'nearend'">
                                                <td hidden>{{n.ID}}</td>
                                                <td>{{n.Email}} </td>
                                                <td>
                                                    <button id="sua1" style="margin-bottom: 0px;" class="btn btn-xs btn-primary" ng-click="suasaphethan(n.ID,n.Email)" data-toggle="modal" data-target="#myModal1">
                                                        <i class="glyphicon glyphicon-pencil"></i> sửa
                                                    </button>
                                                    <button style="margin-bottom: 0px;" class="btn btn-xs btn-danger" ng-click="xoasaphethan(n.ID)">
                                                        <i class="glyphicon glyphicon-trash"></i> xóa
                                                    </button>
                                                </td>                                               
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="col-lg-4">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr>
                                                <th style="font-size: 20px; text-align: center;">
                                                    Email khách hàng đã hêt hạn                                                    
                                                </th>
                                                <th>
                                                    <button id="dahethan" style="margin-bottom: 0px;" class="btn btn-xs btn-primary" data-toggle="modal" data-target="#myModal1">
                                                        <i class="glyphicon glyphicon-user"></i> Thêm
                                                    </button>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="n in ListMail |filter:'afterend'">
                                                <td hidden>{{n.ID}}</td>
                                                <td>{{n.Email}} </td>
                                                <td>
                                                    <button id="sua2" style="margin-bottom: 0px;" class="btn btn-xs btn-primary" ng-click="suadahethan(n.ID,n.Email)" data-toggle="modal" data-target="#myModal1">
                                                        <i class="glyphicon glyphicon-pencil"></i> sửa
                                                    </button>
                                                    <button style="margin-bottom: 0px;" class="btn btn-xs btn-danger" ng-click="xoadahethan(n.ID)">
                                                        <i class="glyphicon glyphicon-trash"></i> xóa
                                                    </button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="col-lg-4">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr>
                                                <th style="font-size: 20px;text-align:center;">
                                                    Email hóa đơn chưa thanh toán                                                    
                                                </th>
                                                <th>
                                                    <button id="chuathanhtoan" style="margin-bottom: 0px;" class="btn btn-xs btn-primary" data-toggle="modal" data-target="#myModal1">
                                                        <i class="glyphicon glyphicon-user"></i> Thêm
                                                    </button>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr><td>Gửi mặc định: Người tạo hóa đơn.</td><td></td></tr>
                                            <tr ng-repeat="n in ListMail |filter:'invoice'">
                                                <td hidden>{{n.ID}}</td>
                                                <td>{{n.Email}} </td>
                                                <td>
                                                    <button id ="sua3" style="margin-bottom: 0px;" class="btn btn-xs btn-primary" ng-click="suachuathanhtoan(n.ID,n.Email)" data-toggle="modal" data-target="#myModal1">
                                                        <i class="glyphicon glyphicon-pencil"></i> sửa
                                                    </button>
                                                    <button style="margin-bottom: 0px;" class="btn btn-xs btn-danger" ng-click="xoachuathanhtoan(n.ID)">
                                                        <i class="glyphicon glyphicon-trash"></i> xóa
                                                    </button>
                                                </td>          
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane" id="tab3" style="font-size: 20px;">

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    
    <script src="~/Scripts/jquery.session.js"></script>
    <script src="~/Scripts/bootstrap-datepicker.js"></script>
    <script type="text/javascript">
        document.getElementById("bangdieukhien").style.color = "blue";
        var loadingIcon = '<div class="sk-circle"><div class="sk-circle1 sk-child"></div><div class="sk-circle2 sk-child"></div><div class="sk-circle3 sk-child"></div><div class="sk-circle4 sk-child"></div><div class="sk-circle5 sk-child"></div><div class="sk-circle6 sk-child"></div><div class="sk-circle7 sk-child"></div><div class="sk-circle8 sk-child"></div><div class="sk-circle9 sk-child"></div><div class="sk-circle10 sk-child"></div><div class="sk-circle11 sk-child"></div><div class="sk-circle12 sk-child"></div></div>'
        $('#loadingicon').append(loadingIcon);
        var app = angular.module("IndexApp", [])
        app.controller('indexcontrol', function ($scope, $http) {
            //get list hoa don
            $http.get("/Vsmartsell/GetListGiaTien").success(function (response) {
                $scope.ListGiaTien = response.ListGiaTien;
                $('#my-tab-content').removeAttr('hidden');
                $('.sk-circle').remove();
            });
            //funciton parseint
            parseint = function(a)
            {
                return Number(a);
            }

            //ham load list email lai             
            reloademail = function()
            {
                document.getElementById("bangdieukhien").style.color = "blue";
                $http.get("/Vsmartsell/ListNoticeMail").success(function (response) {
                    $scope.ListMail = response.ListMail;
                });
                $http.get("/Vsmartsell/GetListGiaTien").success(function (response) {
                    $scope.ListGiaTien = response.ListGiaTien;
                });
            }
            //ham load list loaigoi lai             
            reloadgoi = function () {
                $http.get("/Vsmartsell/GetListGiaTien").success(function (response) {
                    $scope.ListGiaTien = response.ListGiaTien;
                });
            }
            //get email ListNoticeMail
            $http.get("/Vsmartsell/ListNoticeMail").success(function (response) {
                $scope.ListMail = response.ListMail;
            });
            //--------loai goi--------
            //them  AddLoaiGoi(string loaigoi, decimal giatien)       
            $("#taogoi1").click(function () {
                $.post("/vsmartsell/AddLoaiGoi", { loaigoi: $("#loaigoi").val(), giatien: Number($("#giagoi").val()) }, function (data) {
                    reloadgoi();
                });
                
                $('#huy').trigger('click');
            });
            //khi them mat button edit trong loai goi
            $('#taogoi').click(function () {
                document.getElementById("loaigoi").disabled = "";
                $("#loaigoi").val("");
                $("#giagoi").val("");
                $("#taogoi1").show();
                $("#taogoi2").hide();
            })
            // sua gia goi EditGoi(int id, string loaigoi, decimal giatien)
            $scope.taogoi = function (a, b,c) {
                debugger
                $("#loaigoi").val(b);
                $("#giagoi").val(c);
                $("#taogoi2").show();
                $("#taogoi1").hide();
                $("#taogoi2").click(function () {
                    $.post("/vsmartsell/EditGoi", { id: a, loaigoi: $("#loaigoi").val(), giatien: Number($("#giagoi").val()) }, function (data) {
                        debugger;
                        reloadgoi();
                    });
                    
                    $('#huy').trigger('click');
                });
            }
            //xoa goi DelLoaiGoi(int magoi)
            $scope.xoagoi = function (a) {
                debugger
                var strconfirm = confirm("Are you sure you want to delete?");
                if (strconfirm == true) {
                    $.post("/vsmartsell/DelLoaiGoi", { magoi: a }, function (data) {
                        debugger;
                        reloadgoi();
                    });
                }
            }

            //--------sap het han--------
            //khi them mat button edit
            $('#saphethan').click(function () {
                $("#email1").val("");
                $("#saphethan1").show();
                $("#saphethan2").hide();
                $("#dahethan1").hide();
                $("#chuathanhtoan1").hide();
            })
            //them email sap het han (string mailtype, string name, string email)           
            $("#saphethan1").click(function () {
                $.post("/vsmartsell/AddNoticeMail", { mailtype:"nearend",name:"test" ,email: $("#email1").val() }, function (data) {
                });
                reloademail();
                $('#huy').trigger('click');
            });
            //khi sua mat button them
            $scope.suasaphethan = function(a,b)
            {
                $("#email1").val(b);
                $("#saphethan2").show();
                $("#saphethan1").hide();
                $("#dahethan1").hide();
                $("#chuathanhtoan1").hide();
                //sua email sap het han (int? id, string name, string email)
                $("#saphethan2").click(function () {
                    $.post("/vsmartsell/EditNoticeMail", { id: a, name: "test", email: $("#email1").val() }, function (data) {
                    });
                    reloademail();
                    $('#huy1').trigger('click');
                });
            }
            //xoa email sap het han (int? id)
            $scope.xoasaphethan = function (a) {
                var strconfirm = confirm("Are you sure you want to delete?");
                if (strconfirm == true) {
                    $.post("/vsmartsell/DelNoticeMail", { id: a }, function (data) {
                        reloademail();
                    });
                }
            }

            //--------da het han--------
            //khi them mat button edit
            $('#dahethan').click(function () {
                $("#email1").val("");
                $("#saphethan1").show();
                $("#saphethan2").hide();
                $("#chuathanhtoan1").hide();
            })
            //them email da het han (string mailtype, string name, string email)           
            $("#dahethan1").click(function () {
                $.post("/vsmartsell/AddNoticeMail", { mailtype: "afterend", name: "test1", email: $("#email1").val() }, function (data) {
                });
                reloademail();
                $('#huy1').trigger('click');
            });
            //khi sua mat button them
            $scope.suadahethan = function (a, b) {
                $("#email1").val(b);
                $("#saphethan2").show();
                $("#dahethan1").hide();
                $("#saphethan1").hide();
                $("#chuathanhtoan1").hide();
                //sua email sap het han (int? id, string name, string email)
                $("#saphethan2").click(function () {
                    $.post("/vsmartsell/EditNoticeMail", { id: a, name: "test1", email: $("#email1").val() }, function (data) {
                    });
                    reloademail();
                    $('#huy1').trigger('click');
                });
            }
            //xoa email sap het han (int? id)
            $scope.xoadahethan = function (a) {
                var strconfirm = confirm("Are you sure you want to delete?");
                if (strconfirm == true) {
                    $.post("/vsmartsell/DelNoticeMail", { id: a }, function (data) {
                        reloademail();
                    });
                }
            }

            //--------HD chua thanh toan--------
            //khi them mat button edit
            $('#chuathanhtoan').click(function () {
                $("#email1").val("");
                $("#chuathanhtoan1").show();
                $("#saphethan2").hide();
                $("#saphethan1").hide();
                $("#dahethan1").hide();
            })
            //them email da het han (string mailtype, string name, string email)           
            $("#chuathanhtoan1").click(function () {
                $.post("/vsmartsell/AddNoticeMail", { mailtype: "invoice", name: "test2", email: $("#email1").val() }, function (data) {
                });
                reloademail();
                $('#huy1').trigger('click');
            });
            //khi sua mat button them
            $scope.suachuathanhtoan = function (a, b) {
                $("#email1").val(b);
                $("#saphethan2").show();
                $("#dahethan1").hide();
                $("#saphethan1").hide();
                $("#chuathanhtoan1").hide();
                //sua email sap het han (int? id, string name, string email)
                $("#saphethan2").click(function () {
                    $.post("/vsmartsell/EditNoticeMail", { id: a, name: "test2", email: $("#email1").val() }, function (data) {
                    });
                    reloademail();
                    $('#huy1').trigger('click');
                });
            }
            //xoa email sap het han (int? id)
            $scope.xoachuathanhtoan = function (a) {
                var strconfirm = confirm("Are you sure you want to delete?");
                if (strconfirm == true) {
                    $.post("/vsmartsell/DelNoticeMail", { id: a }, function (data) {
                        reloademail();
                    });
                }

            }



        });
    </script>
}